С помощью with можно гн закрывать файл, он сам закроется